2025-06-18 00:05:37,256 [INFO] main:888 - ======================================================================
2025-06-18 00:05:37,256 [INFO] main:889 - SPARK DISTRIBUTED IMAGE STITCHING
2025-06-18 00:05:37,256 [INFO] main:890 - ======================================================================
2025-06-18 00:05:37,256 [INFO] main:896 - Initializing Spark Image Stitcher...
2025-06-18 00:05:37,256 [INFO] __init__:31 - Initializing SparkImageStitcher...
2025-06-18 00:05:37,256 [INFO] __init__:37 - Using Python executable: C:\Users\user\AppData\Local\Programs\Python\Python310\python.exe
2025-06-18 00:05:37,586 [INFO] send_command:538 - Error while receiving.
Traceback (most recent call last):
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "C:\Users\user\AppData\Local\Programs\Python\Python310\lib\socket.py", line 705, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-06-18 00:05:37,590 [INFO] close:543 - Closing down clientserver connection
2025-06-18 00:05:37,590 [ERROR] __init__:85 - Failed to initialize Spark session: Error while sending or receiving
2025-06-18 00:05:37,591 [ERROR] __init__:86 - Traceback (most recent call last):
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "C:\Users\user\AppData\Local\Programs\Python\Python310\lib\socket.py", line 705, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\Keshav\testStitchSpark.py", line 76, in __init__
    self.spark = SparkSession.builder.config(conf=conf).getOrCreate()
  File "C:\Spark\python\lib\pyspark.zip\pyspark\sql\session.py", line 477, in getOrCreate
    sc = SparkContext.getOrCreate(sparkConf)
  File "C:\Spark\python\lib\pyspark.zip\pyspark\context.py", line 512, in getOrCreate
    SparkContext(conf=conf or SparkConf())
  File "C:\Spark\python\lib\pyspark.zip\pyspark\context.py", line 198, in __init__
    SparkContext._ensure_initialized(self, gateway=gateway, conf=conf)
  File "C:\Spark\python\lib\pyspark.zip\pyspark\context.py", line 432, in _ensure_initialized
    SparkContext._gateway = gateway or launch_gateway(conf)
  File "C:\Spark\python\lib\pyspark.zip\pyspark\java_gateway.py", line 150, in launch_gateway
    java_import(gateway.jvm, "org.apache.spark.SparkConf")
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\java_gateway.py", line 180, in java_import
    answer = gateway_client.send_command(command)
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 443, in connect_to_java_server
    self._authenticate_connection()
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 459, in _authenticate_connection
    answer = self.send_command(cmd)
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving

2025-06-18 00:05:37,591 [ERROR] main:968 - Fatal error in main execution: Error while sending or receiving
2025-06-18 00:05:37,591 [ERROR] main:969 - Traceback (most recent call last):
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "C:\Users\user\AppData\Local\Programs\Python\Python310\lib\socket.py", line 705, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\user\Desktop\Keshav\testStitchSpark.py", line 897, in main
    stitcher = SparkImageStitcher(spark_master="spark://10.0.42.43:7077")
  File "C:\Users\user\Desktop\Keshav\testStitchSpark.py", line 76, in __init__
    self.spark = SparkSession.builder.config(conf=conf).getOrCreate()
  File "C:\Spark\python\lib\pyspark.zip\pyspark\sql\session.py", line 477, in getOrCreate
    sc = SparkContext.getOrCreate(sparkConf)
  File "C:\Spark\python\lib\pyspark.zip\pyspark\context.py", line 512, in getOrCreate
    SparkContext(conf=conf or SparkConf())
  File "C:\Spark\python\lib\pyspark.zip\pyspark\context.py", line 198, in __init__
    SparkContext._ensure_initialized(self, gateway=gateway, conf=conf)
  File "C:\Spark\python\lib\pyspark.zip\pyspark\context.py", line 432, in _ensure_initialized
    SparkContext._gateway = gateway or launch_gateway(conf)
  File "C:\Spark\python\lib\pyspark.zip\pyspark\java_gateway.py", line 150, in launch_gateway
    java_import(gateway.jvm, "org.apache.spark.SparkConf")
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\java_gateway.py", line 180, in java_import
    answer = gateway_client.send_command(command)
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 443, in connect_to_java_server
    self._authenticate_connection()
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 459, in _authenticate_connection
    answer = self.send_command(cmd)
  File "C:\Spark\python\lib\py4j-0.10.9.7.zip\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving

2025-06-18 00:05:37,592 [INFO] close:543 - Closing down clientserver connection
2025-06-18 00:05:37,592 [INFO] main:979 - Program execution completed
2025-06-18 00:05:45,735 [INFO] main:888 - ======================================================================
2025-06-18 00:05:45,735 [INFO] main:889 - SPARK DISTRIBUTED IMAGE STITCHING
2025-06-18 00:05:45,735 [INFO] main:890 - ======================================================================
2025-06-18 00:05:45,735 [INFO] main:896 - Initializing Spark Image Stitcher...
2025-06-18 00:05:45,735 [INFO] __init__:31 - Initializing SparkImageStitcher...
2025-06-18 00:05:45,735 [INFO] __init__:37 - Using Python executable: C:\Users\user\AppData\Local\Programs\Python\Python310\python.exe
2025-06-18 00:05:46,971 [INFO] __init__:82 - Spark session initialized successfully. Application ID: app-20250618000546-0007
2025-06-18 00:05:46,971 [INFO] main:903 - Input directory: C:\Users\user\Desktop\Keshav\Nesac_Outreach_Mapping
2025-06-18 00:05:46,971 [INFO] main:904 - Output filename: spark_distributed_panorama.jpg
2025-06-18 00:05:46,971 [INFO] main:912 - Starting distributed stitching process...
2025-06-18 00:05:46,971 [INFO] stitch_images_distributed:736 - ======================================================================
2025-06-18 00:05:46,971 [INFO] stitch_images_distributed:737 - DISTRIBUTED IMAGE STITCHING WITH SPARK
2025-06-18 00:05:46,971 [INFO] stitch_images_distributed:738 - ======================================================================
2025-06-18 00:05:46,971 [INFO] stitch_images_distributed:739 - Input directory: C:\Users\user\Desktop\Keshav\Nesac_Outreach_Mapping
2025-06-18 00:05:46,971 [INFO] stitch_images_distributed:740 - Minimum match count: 10
2025-06-18 00:05:46,971 [INFO] stitch_images_distributed:741 - Match ratio threshold: 0.6
2025-06-18 00:05:46,971 [INFO] stitch_images_distributed:742 - ======================================================================
2025-06-18 00:05:46,971 [INFO] stitch_images_distributed:748 - 
==================================================
2025-06-18 00:05:46,971 [INFO] stitch_images_distributed:749 - STEP 1: LOADING IMAGES
2025-06-18 00:05:46,971 [INFO] stitch_images_distributed:750 - ==================================================
2025-06-18 00:05:46,971 [INFO] load_images_distributed:137 - Searching for files with extensions: ['.jpg', '.jpeg', '.png', '.bmp', '.tiff', '.tif']
2025-06-18 00:05:46,971 [INFO] load_images_distributed:139 - Loading images from: C:\Users\user\Desktop\Keshav\Nesac_Outreach_Mapping
2025-06-18 00:05:46,972 [INFO] load_images_distributed:156 - Found 52 image files
2025-06-18 00:06:00,912 [INFO] load_images_distributed:217 - Successfully loaded 52 out of 52 images
2025-06-18 00:06:00,913 [INFO] load_images_distributed:223 - All files: ['DJI_0437.JPG', 'DJI_0438.JPG', 'DJI_0439.JPG', 'DJI_0440.JPG', 'DJI_0441.JPG', 'DJI_0442.JPG', 'DJI_0443.JPG', 'DJI_0444.JPG', 'DJI_0445.JPG', 'DJI_0446.JPG', 'DJI_0447.JPG', 'DJI_0448.JPG', 'DJI_0449.JPG', 'DJI_0450.JPG', 'DJI_0451.JPG', 'DJI_0452.JPG', 'DJI_0453.JPG', 'DJI_0454.JPG', 'DJI_0455.JPG', 'DJI_0456.JPG', 'DJI_0457.JPG', 'DJI_0458.JPG', 'DJI_0459.JPG', 'DJI_0460.JPG', 'DJI_0461.JPG', 'DJI_0462.JPG', 'DJI_0463.JPG', 'DJI_0464.JPG', 'DJI_0465.JPG', 'DJI_0466.JPG', 'DJI_0467.JPG', 'DJI_0468.JPG', 'DJI_0469.JPG', 'DJI_0470.JPG', 'DJI_0471.JPG', 'DJI_0472.JPG', 'DJI_0473.JPG', 'DJI_0474.JPG', 'DJI_0475.JPG', 'DJI_0476.JPG', 'DJI_0477.JPG', 'DJI_0478.JPG', 'DJI_0479.JPG', 'DJI_0480.JPG', 'DJI_0481.JPG', 'DJI_0482.JPG', 'DJI_0483.JPG', 'DJI_0484.JPG', 'DJI_0485.JPG', 'DJI_0486.JPG', 'DJI_0487.JPG', 'DJI_0488.JPG', 'Thumbs.db']
2025-06-18 00:06:00,913 [INFO] load_images_distributed:224 - Image files: ['DJI_0437.JPG', 'DJI_0438.JPG', 'DJI_0439.JPG', 'DJI_0440.JPG', 'DJI_0441.JPG', 'DJI_0442.JPG', 'DJI_0443.JPG', 'DJI_0444.JPG', 'DJI_0445.JPG', 'DJI_0446.JPG', 'DJI_0447.JPG', 'DJI_0448.JPG', 'DJI_0449.JPG', 'DJI_0450.JPG', 'DJI_0451.JPG', 'DJI_0452.JPG', 'DJI_0453.JPG', 'DJI_0454.JPG', 'DJI_0455.JPG', 'DJI_0456.JPG', 'DJI_0457.JPG', 'DJI_0458.JPG', 'DJI_0459.JPG', 'DJI_0460.JPG', 'DJI_0461.JPG', 'DJI_0462.JPG', 'DJI_0463.JPG', 'DJI_0464.JPG', 'DJI_0465.JPG', 'DJI_0466.JPG', 'DJI_0467.JPG', 'DJI_0468.JPG', 'DJI_0469.JPG', 'DJI_0470.JPG', 'DJI_0471.JPG', 'DJI_0472.JPG', 'DJI_0473.JPG', 'DJI_0474.JPG', 'DJI_0475.JPG', 'DJI_0476.JPG', 'DJI_0477.JPG', 'DJI_0478.JPG', 'DJI_0479.JPG', 'DJI_0480.JPG', 'DJI_0481.JPG', 'DJI_0482.JPG', 'DJI_0483.JPG', 'DJI_0484.JPG', 'DJI_0485.JPG', 'DJI_0486.JPG', 'DJI_0487.JPG', 'DJI_0488.JPG']
2025-06-18 00:06:00,913 [INFO] stitch_images_distributed:755 - Image loading completed in 13.94 seconds
2025-06-18 00:06:00,913 [INFO] stitch_images_distributed:756 - Images loaded: 52
2025-06-18 00:06:00,917 [INFO] stitch_images_distributed:767 - 
==================================================
2025-06-18 00:06:00,917 [INFO] stitch_images_distributed:768 - STEP 2: FEATURE EXTRACTION
2025-06-18 00:06:00,917 [INFO] stitch_images_distributed:769 - ==================================================
2025-06-18 00:06:00,917 [INFO] extract_features_distributed:235 - Extracting features from 52 images...
2025-06-18 00:06:07,901 [INFO] extract_features_distributed:314 - Feature extraction completed for 52 images
2025-06-18 00:06:07,902 [INFO] stitch_images_distributed:774 - Feature extraction completed in 6.98 seconds
2025-06-18 00:06:07,902 [INFO] stitch_images_distributed:775 - Images with features: 52
2025-06-18 00:06:07,930 [INFO] stitch_images_distributed:785 - 
==================================================
2025-06-18 00:06:07,930 [INFO] stitch_images_distributed:786 - STEP 3: FEATURE MATCHING
2025-06-18 00:06:07,930 [INFO] stitch_images_distributed:787 - ==================================================
2025-06-18 00:06:07,930 [INFO] find_matches_parallel:330 - Finding matches between 52 images with ratio 0.6...
2025-06-18 00:06:07,930 [INFO] find_matches_parallel:442 - Created 51 adjacent image pairs for matching
2025-06-18 00:06:07,930 [INFO] find_matches_parallel:457 - Processing batch 1/6 (10 pairs)
2025-06-18 00:06:13,298 [INFO] find_matches_parallel:469 - Matched ('DJI_0437.JPG', 'DJI_0438.JPG'): 62 matches (detector: ORB, score: 2.160)
2025-06-18 00:06:13,298 [INFO] find_matches_parallel:469 - Matched ('DJI_0438.JPG', 'DJI_0439.JPG'): 65 matches (detector: ORB, score: 2.163)
2025-06-18 00:06:13,298 [INFO] find_matches_parallel:469 - Matched ('DJI_0439.JPG', 'DJI_0440.JPG'): 123 matches (detector: ORB, score: 4.459)
2025-06-18 00:06:13,298 [INFO] find_matches_parallel:469 - Matched ('DJI_0440.JPG', 'DJI_0441.JPG'): 116 matches (detector: ORB, score: 4.144)
2025-06-18 00:06:13,298 [INFO] find_matches_parallel:469 - Matched ('DJI_0441.JPG', 'DJI_0442.JPG'): 89 matches (detector: ORB, score: 3.260)
2025-06-18 00:06:13,298 [INFO] find_matches_parallel:469 - Matched ('DJI_0442.JPG', 'DJI_0443.JPG'): 44 matches (detector: ORB, score: 1.458)
2025-06-18 00:06:13,299 [INFO] find_matches_parallel:469 - Matched ('DJI_0443.JPG', 'DJI_0444.JPG'): 88 matches (detector: ORB, score: 3.179)
2025-06-18 00:06:13,299 [INFO] find_matches_parallel:469 - Matched ('DJI_0444.JPG', 'DJI_0445.JPG'): 38 matches (detector: ORB, score: 1.314)
2025-06-18 00:06:13,299 [INFO] find_matches_parallel:469 - Matched ('DJI_0445.JPG', 'DJI_0446.JPG'): 47 matches (detector: ORB, score: 1.727)
2025-06-18 00:06:13,299 [INFO] find_matches_parallel:469 - Matched ('DJI_0446.JPG', 'DJI_0447.JPG'): 48 matches (detector: ORB, score: 1.936)
2025-06-18 00:06:13,328 [INFO] find_matches_parallel:457 - Processing batch 2/6 (10 pairs)
2025-06-18 00:06:18,732 [INFO] find_matches_parallel:469 - Matched ('DJI_0447.JPG', 'DJI_0448.JPG'): 43 matches (detector: ORB, score: 1.546)
2025-06-18 00:06:18,732 [INFO] find_matches_parallel:469 - Matched ('DJI_0448.JPG', 'DJI_0449.JPG'): 16 matches (detector: ORB, score: 0.533)
2025-06-18 00:06:18,732 [INFO] find_matches_parallel:469 - Matched ('DJI_0449.JPG', 'DJI_0450.JPG'): 6 matches (detector: ORB, score: 0.159)
2025-06-18 00:06:18,733 [INFO] find_matches_parallel:469 - Matched ('DJI_0450.JPG', 'DJI_0451.JPG'): 47 matches (detector: ORB, score: 1.617)
2025-06-18 00:06:18,733 [INFO] find_matches_parallel:469 - Matched ('DJI_0451.JPG', 'DJI_0452.JPG'): 85 matches (detector: ORB, score: 3.893)
2025-06-18 00:06:18,733 [INFO] find_matches_parallel:469 - Matched ('DJI_0452.JPG', 'DJI_0453.JPG'): 99 matches (detector: ORB, score: 3.800)
2025-06-18 00:06:18,733 [INFO] find_matches_parallel:469 - Matched ('DJI_0453.JPG', 'DJI_0454.JPG'): 68 matches (detector: ORB, score: 2.387)
2025-06-18 00:06:18,733 [INFO] find_matches_parallel:469 - Matched ('DJI_0454.JPG', 'DJI_0455.JPG'): 85 matches (detector: ORB, score: 3.299)
2025-06-18 00:06:18,733 [INFO] find_matches_parallel:469 - Matched ('DJI_0455.JPG', 'DJI_0456.JPG'): 61 matches (detector: ORB, score: 2.317)
2025-06-18 00:06:18,733 [INFO] find_matches_parallel:469 - Matched ('DJI_0456.JPG', 'DJI_0457.JPG'): 97 matches (detector: ORB, score: 4.068)
2025-06-18 00:06:18,762 [INFO] find_matches_parallel:457 - Processing batch 3/6 (10 pairs)
2025-06-18 00:06:24,095 [INFO] find_matches_parallel:469 - Matched ('DJI_0457.JPG', 'DJI_0458.JPG'): 127 matches (detector: ORB, score: 5.943)
2025-06-18 00:06:24,095 [INFO] find_matches_parallel:469 - Matched ('DJI_0458.JPG', 'DJI_0459.JPG'): 93 matches (detector: ORB, score: 3.281)
2025-06-18 00:06:24,095 [INFO] find_matches_parallel:469 - Matched ('DJI_0459.JPG', 'DJI_0460.JPG'): 46 matches (detector: ORB, score: 1.666)
2025-06-18 00:06:24,095 [INFO] find_matches_parallel:469 - Matched ('DJI_0460.JPG', 'DJI_0461.JPG'): 58 matches (detector: ORB, score: 2.187)
2025-06-18 00:06:24,095 [INFO] find_matches_parallel:469 - Matched ('DJI_0461.JPG', 'DJI_0462.JPG'): 13 matches (detector: ORB, score: 0.398)
2025-06-18 00:06:24,095 [INFO] find_matches_parallel:469 - Matched ('DJI_0462.JPG', 'DJI_0463.JPG'): 40 matches (detector: ORB, score: 1.502)
2025-06-18 00:06:24,095 [INFO] find_matches_parallel:469 - Matched ('DJI_0463.JPG', 'DJI_0464.JPG'): 36 matches (detector: ORB, score: 1.312)
2025-06-18 00:06:24,095 [INFO] find_matches_parallel:469 - Matched ('DJI_0464.JPG', 'DJI_0465.JPG'): 40 matches (detector: ORB, score: 1.417)
2025-06-18 00:06:24,095 [INFO] find_matches_parallel:469 - Matched ('DJI_0465.JPG', 'DJI_0466.JPG'): 56 matches (detector: ORB, score: 1.885)
2025-06-18 00:06:24,095 [INFO] find_matches_parallel:469 - Matched ('DJI_0466.JPG', 'DJI_0467.JPG'): 55 matches (detector: ORB, score: 1.997)
2025-06-18 00:06:24,122 [INFO] find_matches_parallel:457 - Processing batch 4/6 (10 pairs)
2025-06-18 00:06:29,470 [INFO] find_matches_parallel:469 - Matched ('DJI_0467.JPG', 'DJI_0468.JPG'): 74 matches (detector: ORB, score: 2.914)
2025-06-18 00:06:29,470 [INFO] find_matches_parallel:469 - Matched ('DJI_0468.JPG', 'DJI_0469.JPG'): 86 matches (detector: ORB, score: 2.981)
2025-06-18 00:06:29,470 [INFO] find_matches_parallel:469 - Matched ('DJI_0469.JPG', 'DJI_0470.JPG'): 41 matches (detector: ORB, score: 1.544)
2025-06-18 00:06:29,470 [INFO] find_matches_parallel:469 - Matched ('DJI_0470.JPG', 'DJI_0471.JPG'): 61 matches (detector: ORB, score: 2.047)
2025-06-18 00:06:29,470 [INFO] find_matches_parallel:469 - Matched ('DJI_0471.JPG', 'DJI_0472.JPG'): 85 matches (detector: SIFT, score: 0.607)
2025-06-18 00:06:29,470 [INFO] find_matches_parallel:469 - Matched ('DJI_0472.JPG', 'DJI_0473.JPG'): 25 matches (detector: ORB, score: 0.799)
2025-06-18 00:06:29,470 [INFO] find_matches_parallel:469 - Matched ('DJI_0473.JPG', 'DJI_0474.JPG'): 39 matches (detector: ORB, score: 1.461)
2025-06-18 00:06:29,470 [INFO] find_matches_parallel:469 - Matched ('DJI_0474.JPG', 'DJI_0475.JPG'): 11 matches (detector: SIFT, score: 0.077)
2025-06-18 00:06:29,470 [INFO] find_matches_parallel:469 - Matched ('DJI_0475.JPG', 'DJI_0476.JPG'): 33 matches (detector: ORB, score: 1.119)
2025-06-18 00:06:29,470 [INFO] find_matches_parallel:469 - Matched ('DJI_0476.JPG', 'DJI_0477.JPG'): 31 matches (detector: ORB, score: 1.106)
2025-06-18 00:06:29,498 [INFO] find_matches_parallel:457 - Processing batch 5/6 (10 pairs)
2025-06-18 00:06:34,792 [INFO] find_matches_parallel:469 - Matched ('DJI_0477.JPG', 'DJI_0478.JPG'): 61 matches (detector: ORB, score: 2.112)
2025-06-18 00:06:34,792 [INFO] find_matches_parallel:469 - Matched ('DJI_0478.JPG', 'DJI_0479.JPG'): 80 matches (detector: ORB, score: 2.959)
2025-06-18 00:06:34,792 [INFO] find_matches_parallel:469 - Matched ('DJI_0479.JPG', 'DJI_0480.JPG'): 67 matches (detector: ORB, score: 2.475)
2025-06-18 00:06:34,792 [INFO] find_matches_parallel:469 - Matched ('DJI_0480.JPG', 'DJI_0481.JPG'): 83 matches (detector: ORB, score: 3.268)
2025-06-18 00:06:34,792 [INFO] find_matches_parallel:469 - Matched ('DJI_0481.JPG', 'DJI_0482.JPG'): 67 matches (detector: ORB, score: 2.266)
2025-06-18 00:06:34,792 [INFO] find_matches_parallel:469 - Matched ('DJI_0482.JPG', 'DJI_0483.JPG'): 56 matches (detector: ORB, score: 1.994)
2025-06-18 00:06:34,792 [INFO] find_matches_parallel:469 - Matched ('DJI_0483.JPG', 'DJI_0484.JPG'): 58 matches (detector: ORB, score: 2.059)
2025-06-18 00:06:34,792 [INFO] find_matches_parallel:469 - Matched ('DJI_0484.JPG', 'DJI_0485.JPG'): 54 matches (detector: ORB, score: 2.124)
2025-06-18 00:06:34,792 [INFO] find_matches_parallel:469 - Matched ('DJI_0485.JPG', 'DJI_0486.JPG'): 66 matches (detector: ORB, score: 2.324)
2025-06-18 00:06:34,792 [INFO] find_matches_parallel:469 - Matched ('DJI_0486.JPG', 'DJI_0487.JPG'): 46 matches (detector: ORB, score: 1.662)
2025-06-18 00:06:34,819 [INFO] find_matches_parallel:457 - Processing batch 6/6 (1 pairs)
2025-06-18 00:06:39,855 [INFO] find_matches_parallel:469 - Matched ('DJI_0487.JPG', 'DJI_0488.JPG'): 62 matches (detector: ORB, score: 2.363)
2025-06-18 00:06:39,886 [INFO] stitch_images_distributed:792 - Feature matching completed in 31.96 seconds
2025-06-18 00:06:39,886 [INFO] stitch_images_distributed:793 - Image pairs processed: 51
2025-06-18 00:06:39,912 [INFO] stitch_images_distributed:799 - 
MATCH RESULTS SUMMARY:
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:800 - --------------------------------------------------
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:811 - Pair 1: DJI_0437.JPG -> DJI_0438.JPG
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:812 -   Matches: 62 | Detector: ORB | Score: 2.160 | VALID
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:811 - Pair 2: DJI_0438.JPG -> DJI_0439.JPG
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:812 -   Matches: 65 | Detector: ORB | Score: 2.163 | VALID
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:811 - Pair 3: DJI_0439.JPG -> DJI_0440.JPG
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:812 -   Matches: 123 | Detector: ORB | Score: 4.459 | VALID
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:811 - Pair 4: DJI_0440.JPG -> DJI_0441.JPG
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:812 -   Matches: 116 | Detector: ORB | Score: 4.144 | VALID
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:811 - Pair 5: DJI_0441.JPG -> DJI_0442.JPG
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:812 -   Matches: 89 | Detector: ORB | Score: 3.260 | VALID
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:811 - Pair 6: DJI_0442.JPG -> DJI_0443.JPG
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:812 -   Matches: 44 | Detector: ORB | Score: 1.458 | VALID
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:811 - Pair 7: DJI_0443.JPG -> DJI_0444.JPG
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:812 -   Matches: 88 | Detector: ORB | Score: 3.179 | VALID
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:811 - Pair 8: DJI_0444.JPG -> DJI_0445.JPG
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:812 -   Matches: 38 | Detector: ORB | Score: 1.314 | VALID
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:811 - Pair 9: DJI_0445.JPG -> DJI_0446.JPG
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:812 -   Matches: 47 | Detector: ORB | Score: 1.727 | VALID
2025-06-18 00:06:39,913 [INFO] stitch_images_distributed:811 - Pair 10: DJI_0446.JPG -> DJI_0447.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 48 | Detector: ORB | Score: 1.936 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 11: DJI_0447.JPG -> DJI_0448.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 43 | Detector: ORB | Score: 1.546 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 12: DJI_0448.JPG -> DJI_0449.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 16 | Detector: ORB | Score: 0.533 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 13: DJI_0449.JPG -> DJI_0450.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 6 | Detector: ORB | Score: 0.159 | X INSUFFICIENT
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 14: DJI_0450.JPG -> DJI_0451.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 47 | Detector: ORB | Score: 1.617 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 15: DJI_0451.JPG -> DJI_0452.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 85 | Detector: ORB | Score: 3.893 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 16: DJI_0452.JPG -> DJI_0453.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 99 | Detector: ORB | Score: 3.800 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 17: DJI_0453.JPG -> DJI_0454.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 68 | Detector: ORB | Score: 2.387 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 18: DJI_0454.JPG -> DJI_0455.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 85 | Detector: ORB | Score: 3.299 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 19: DJI_0455.JPG -> DJI_0456.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 61 | Detector: ORB | Score: 2.317 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 20: DJI_0456.JPG -> DJI_0457.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 97 | Detector: ORB | Score: 4.068 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 21: DJI_0457.JPG -> DJI_0458.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 127 | Detector: ORB | Score: 5.943 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 22: DJI_0458.JPG -> DJI_0459.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 93 | Detector: ORB | Score: 3.281 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 23: DJI_0459.JPG -> DJI_0460.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 46 | Detector: ORB | Score: 1.666 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 24: DJI_0460.JPG -> DJI_0461.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 58 | Detector: ORB | Score: 2.187 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 25: DJI_0461.JPG -> DJI_0462.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 13 | Detector: ORB | Score: 0.398 | VALID
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:811 - Pair 26: DJI_0462.JPG -> DJI_0463.JPG
2025-06-18 00:06:39,914 [INFO] stitch_images_distributed:812 -   Matches: 40 | Detector: ORB | Score: 1.502 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 27: DJI_0463.JPG -> DJI_0464.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 36 | Detector: ORB | Score: 1.312 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 28: DJI_0464.JPG -> DJI_0465.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 40 | Detector: ORB | Score: 1.417 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 29: DJI_0465.JPG -> DJI_0466.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 56 | Detector: ORB | Score: 1.885 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 30: DJI_0466.JPG -> DJI_0467.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 55 | Detector: ORB | Score: 1.997 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 31: DJI_0467.JPG -> DJI_0468.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 74 | Detector: ORB | Score: 2.914 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 32: DJI_0468.JPG -> DJI_0469.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 86 | Detector: ORB | Score: 2.981 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 33: DJI_0469.JPG -> DJI_0470.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 41 | Detector: ORB | Score: 1.544 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 34: DJI_0470.JPG -> DJI_0471.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 61 | Detector: ORB | Score: 2.047 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 35: DJI_0471.JPG -> DJI_0472.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 85 | Detector: SIFT | Score: 0.607 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 36: DJI_0472.JPG -> DJI_0473.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 25 | Detector: ORB | Score: 0.799 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 37: DJI_0473.JPG -> DJI_0474.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 39 | Detector: ORB | Score: 1.461 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 38: DJI_0474.JPG -> DJI_0475.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 11 | Detector: SIFT | Score: 0.077 | VALID
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:811 - Pair 39: DJI_0475.JPG -> DJI_0476.JPG
2025-06-18 00:06:39,915 [INFO] stitch_images_distributed:812 -   Matches: 33 | Detector: ORB | Score: 1.119 | VALID
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:811 - Pair 40: DJI_0476.JPG -> DJI_0477.JPG
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:812 -   Matches: 31 | Detector: ORB | Score: 1.106 | VALID
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:811 - Pair 41: DJI_0477.JPG -> DJI_0478.JPG
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:812 -   Matches: 61 | Detector: ORB | Score: 2.112 | VALID
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:811 - Pair 42: DJI_0478.JPG -> DJI_0479.JPG
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:812 -   Matches: 80 | Detector: ORB | Score: 2.959 | VALID
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:811 - Pair 43: DJI_0479.JPG -> DJI_0480.JPG
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:812 -   Matches: 67 | Detector: ORB | Score: 2.475 | VALID
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:811 - Pair 44: DJI_0480.JPG -> DJI_0481.JPG
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:812 -   Matches: 83 | Detector: ORB | Score: 3.268 | VALID
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:811 - Pair 45: DJI_0481.JPG -> DJI_0482.JPG
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:812 -   Matches: 67 | Detector: ORB | Score: 2.266 | VALID
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:811 - Pair 46: DJI_0482.JPG -> DJI_0483.JPG
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:812 -   Matches: 56 | Detector: ORB | Score: 1.994 | VALID
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:811 - Pair 47: DJI_0483.JPG -> DJI_0484.JPG
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:812 -   Matches: 58 | Detector: ORB | Score: 2.059 | VALID
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:811 - Pair 48: DJI_0484.JPG -> DJI_0485.JPG
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:812 -   Matches: 54 | Detector: ORB | Score: 2.124 | VALID
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:811 - Pair 49: DJI_0485.JPG -> DJI_0486.JPG
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:812 -   Matches: 66 | Detector: ORB | Score: 2.324 | VALID
2025-06-18 00:06:39,916 [INFO] stitch_images_distributed:811 - Pair 50: DJI_0486.JPG -> DJI_0487.JPG
2025-06-18 00:06:39,917 [INFO] stitch_images_distributed:812 -   Matches: 46 | Detector: ORB | Score: 1.662 | VALID
2025-06-18 00:06:39,917 [INFO] stitch_images_distributed:811 - Pair 51: DJI_0487.JPG -> DJI_0488.JPG
2025-06-18 00:06:39,917 [INFO] stitch_images_distributed:812 -   Matches: 62 | Detector: ORB | Score: 2.363 | VALID
2025-06-18 00:06:39,917 [INFO] stitch_images_distributed:815 - 
Total matches found: 3077
2025-06-18 00:06:39,917 [INFO] stitch_images_distributed:816 - Valid pairs (>=10 matches): 50/51
2025-06-18 00:06:39,917 [INFO] stitch_images_distributed:823 - 
==================================================
2025-06-18 00:06:39,917 [INFO] stitch_images_distributed:824 - STEP 4: SEQUENTIAL STITCHING
2025-06-18 00:06:39,917 [INFO] stitch_images_distributed:825 - ==================================================
2025-06-18 00:06:39,917 [INFO] stitch_sequentially:620 - Starting sequential stitching...
2025-06-18 00:06:40,017 [INFO] _try_stitch_with_images:681 - Attempting to stitch 52 images...
2025-06-18 00:06:40,030 [INFO] _try_stitch_with_images:710 - Calculating cumulative homographies...
2025-06-18 00:06:40,030 [WARNING] _try_stitch_with_images:718 - Broken link in homography chain. Stitching will stop here.
2025-06-18 00:06:40,030 [INFO] warp_and_blend_all:487 - Starting global warping and simple feather blending of all images.
2025-06-18 00:06:40,031 [INFO] warp_and_blend_all:511 - Calculated canvas size: 485x853
2025-06-18 00:06:40,031 [INFO] warp_and_blend_all:554 - Estimated memory requirement: 4.7 MB
2025-06-18 00:06:40,031 [INFO] warp_and_blend_all:568 - Processing 52 images for blending...
2025-06-18 00:06:40,143 [INFO] warp_and_blend_all:596 - Saved uncropped panorama
2025-06-18 00:06:40,143 [INFO] warp_and_blend_all:601 - Cropping final panorama...
2025-06-18 00:06:40,144 [INFO] warp_and_blend_all:609 - Cropped panorama size: 485x853
2025-06-18 00:06:40,145 [INFO] _try_stitch_with_images:730 - Computed 13 valid global homographies.
2025-06-18 00:06:40,146 [INFO] stitch_images_distributed:829 - Sequential stitching completed in 0.23 seconds
2025-06-18 00:06:40,146 [INFO] stitch_images_distributed:834 - 
======================================================================
2025-06-18 00:06:40,146 [INFO] stitch_images_distributed:835 - TIMING SUMMARY
2025-06-18 00:06:40,146 [INFO] stitch_images_distributed:836 - ======================================================================
2025-06-18 00:06:40,146 [INFO] stitch_images_distributed:837 - Total processing time: 53.18 seconds
2025-06-18 00:06:40,146 [INFO] stitch_images_distributed:838 -   * Image loading:     13.94s (26.2%)
2025-06-18 00:06:40,146 [INFO] stitch_images_distributed:839 -   * Feature extraction: 6.98s (13.1%)
2025-06-18 00:06:40,146 [INFO] stitch_images_distributed:840 -   * Feature matching:   31.96s (60.1%)
2025-06-18 00:06:40,146 [INFO] stitch_images_distributed:841 -   * Image stitching:    0.23s (0.4%)
2025-06-18 00:06:40,146 [INFO] stitch_images_distributed:842 - ======================================================================
2025-06-18 00:06:40,146 [INFO] stitch_images_distributed:845 - SUCCESS! Final panorama shape: (853, 485, 3)
2025-06-18 00:06:40,231 [INFO] stitch_images_distributed:863 - Sharpened and contrast-enhanced panoramas saved as 'spark_distributed_panorama_sharpened.jpg' and 'spark_distributed_panorama_enhanced.jpg'
2025-06-18 00:06:40,258 [INFO] main:923 - Saving panorama to: spark_distributed_panorama.jpg
2025-06-18 00:06:40,261 [INFO] main:927 -  Panorama saved successfully: spark_distributed_panorama.jpg
2025-06-18 00:06:40,261 [INFO] main:931 -   File size: 0.16 MB
2025-06-18 00:06:40,261 [INFO] main:932 -   Image dimensions: (853, 485, 3)
2025-06-18 00:06:40,518 [INFO] main:939 - Attempting to display result...
2025-06-18 00:06:47,022 [INFO] main:949 - Panorama displayed and preview saved
2025-06-18 00:06:47,022 [INFO] stop:879 - Stopping Spark session...
2025-06-18 00:06:47,897 [INFO] stop:881 - Spark session stopped successfully
2025-06-18 00:06:47,897 [INFO] main:979 - Program execution completed
2025-06-18 00:06:47,898 [INFO] close:543 - Closing down clientserver connection
